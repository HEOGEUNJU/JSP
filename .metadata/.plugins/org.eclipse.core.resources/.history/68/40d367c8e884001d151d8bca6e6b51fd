package kr.or.ddit.member.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import kr.or.ddit.db.ConnectionFactory;
import kr.or.ddit.vo.MemberVO;

public class MemberDAOImpl extends AbstractJDBCDAO implements MemberDAO {

	@Override
	public int insertMember(MemberVO member) {
		
		return 0;
	}

	@Override
	public void queryParameterSetting(PreparedStatement pstmt, Object... params) {
		
	}

	@Override
	public <T> T resultBindingForOneRecord(ResultSet rs, Class<T> resultType) {
		try {
			T resultObject = resultType.newInstance();
			
			MemberVO member = (MemberVO)resultObject;
			member.setMemId(rs.getString("mem_id"));
			member.setMemName(rs.getString("mem_name"));
			member.setMemMail(rs.getString("MEM_MAIL"));
			member.setMemHp(rs.getString("MEM_HP"));
			member.setMemAdd1(rs.getString("MEM_ADD1"));
			member.setMemMileage(rs.getInt("mem_mileage"));
			
			return resultObject;
		}catch (Exception e) {
			throw new RuntimeException();
		}
	}
	
	@Override
	public List<MemberVO> selectMemberList() {
		StringBuffer sql = new StringBuffer();
		sql.append("select mem_id, mem_name, MEM_MAIL, MEM_HP, MEM_ADD1, mem_mileage  ");
		sql.append("from member");
		
		return selectList(sql.toString(), MemberVO.class);
	}

	@Override
	public MemberVO selectMember(String memId) {
		StringBuffer sql = new StringBuffer();
		sql.append("SELECT                                               ");
	    sql.append("mem_id,     mem_pass,   mem_name,                    ");
	    sql.append("mem_regno1, mem_regno2,                              ");
	    sql.append("To_Char(mem_bir,'YYYY-MM-DD')mem_bir,                ");
	    sql.append("mem_zip,    mem_add1,   mem_add2,                    ");
	    sql.append("mem_hometel,mem_comtel, mem_hp,                      ");
	    sql.append("mem_mail,   mem_job,    mem_like,                    ");
	    sql.append("mem_memorial,                                        ");
	    sql.append("To_Char(mem_memorialday,'YYYY-MM-DD')mem_memorialday,");
	    sql.append("mem_mileage,                                         ");
	    sql.append("mem_delete                                           ");
	    sql.append("FROM                                                 ");
	    sql.append("member                                               ");
	    sql.append("where mem_id = ?                        	         ");
	    
	    return selectOne(sql.toString(), MemberVO.class , memId);
	}                                                                  
	

	@Override
	public int updateMember(MemberVO member) {
		// TODO Auto-generated method stub
		return 0;
	}

	@Override
	public int deletemember(String memId) {
		// TODO Auto-generated method stub
		return 0;
	}

}
